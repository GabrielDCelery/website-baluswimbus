var AdminApp=angular.module("AdminApp",["ngRoute","ngCookies","AuthCtrl","AuthFactory","AddNewCtrl","PostsCtrl","ui.tinymce","DatabaseFactory","TextEditorFactory","AlertsFactory"]);AdminApp.config(["$routeProvider","$locationProvider",function(t,e){t.when("/posts",{templateUrl:"templates/_posts.html",controller:"PostsCtrl"}).when("/addnew",{templateUrl:"templates/_addnew.html",controller:"AddNewCtrl"}).when("/:id",{templateUrl:"templates/_edit.html"}).otherwise({redirectTo:"/"})}]);var AuthCtrl=angular.module("AuthCtrl",[]);AuthCtrl.controller("AuthCtrl",["$scope","AuthFactory",function(t,e){function o(o,r){e.login(o,r,function(a){a.data?(t.loggedIn=!0,e.setLoginCookie(o,r)):t.loggedIn=!1})}function r(){t.loggedIn=!1,e.clearLoginCookie()}function a(t){e.getLoginCookie(t)}t.loggedIn=!1,t.login=o,t.logout=r,a(o)}]);var AuthFactory=angular.module("AuthFactory",[]);AuthFactory.factory("AuthFactory",["$http","$cookies",function(t,e){function o(e,o,r){t.post("php/login.php",{username:e,password:o}).success(r)}function r(t,o){var r=i.encode(t),a=i.encode(o),n={username:r,password:a};e.putObject("userCookie",n)}function a(){e.remove("userCookie")}function n(t){var o=e.getObject("userCookie");if(o){var r=i.decode(o.username),a=i.decode(o.password);t(r,a)}}var i={keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var e,o,r,a,n,i="",s="",c="",l=0;do e=t.charCodeAt(l++),o=t.charCodeAt(l++),s=t.charCodeAt(l++),r=e>>2,a=(3&e)<<4|o>>4,n=(15&o)<<2|s>>6,c=63&s,isNaN(o)?n=c=64:isNaN(s)&&(c=64),i=i+this.keyStr.charAt(r)+this.keyStr.charAt(a)+this.keyStr.charAt(n)+this.keyStr.charAt(c),e=o=s="",r=a=n=c="";while(l<t.length);return i},decode:function(t){var e,o,r,a,n,i="",s="",c="",l=0,d=/[^A-Za-z0-9\+\/\=]/g;d.exec(t)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do r=this.keyStr.indexOf(t.charAt(l++)),a=this.keyStr.indexOf(t.charAt(l++)),n=this.keyStr.indexOf(t.charAt(l++)),c=this.keyStr.indexOf(t.charAt(l++)),e=r<<2|a>>4,o=(15&a)<<4|n>>2,s=(3&n)<<6|c,i+=String.fromCharCode(e),64!=n&&(i+=String.fromCharCode(o)),64!=c&&(i+=String.fromCharCode(s)),e=o=s="",r=a=n=c="";while(l<t.length);return i}};return{login:o,setLoginCookie:r,clearLoginCookie:a,getLoginCookie:n}}]);var AddNewCtrl=angular.module("AddNewCtrl",[]);AddNewCtrl.controller("AddNewCtrl",["$scope","TextEditor","Database","Alerts",function(t,e,o,r){function a(a){t.postData.input=e.checkInput(t.tinymceModel),t.postData.status=a,o.addNewPost(t.postData,function(t){r.checkSuccess(t.data)})}t.postData={title:"",date:new Date,input:"",status:""},tinyMCE.init({selector:"textarea",height:350}),t.addNewPost=a}]);var PostsCtrl=angular.module("PostsCtrl",[]);PostsCtrl.controller("PostsCtrl",["$scope","Alerts","Database",function(t,e,o){function r(){o.getListOfPosts(function(e){t.listOfPosts=e.data})}function a(t){e.confirmChange(function(){o.deletePost(t,function(t){e.checkSuccess(t.data),r()})})}t.listOfPosts,t.sortorder="date",t.reverseOrder=!1,t.deletePost=a,r()}]);var DatabaseFactory=angular.module("DatabaseFactory",[]);DatabaseFactory.factory("Database",["$http",function(t){function e(e){t.get("php/get_list_of_posts.php").then(e)}function o(e,o){t.post("php/save_post.php",e).then(o)}function r(e,o){t.post("php/delete_post.php",e).then(o)}return{getListOfPosts:e,addNewPost:o,deletePost:r}}]);var TextEditorFactory=angular.module("TextEditorFactory",[]);TextEditorFactory.factory("TextEditor",["$http",function(t){function e(t){return t||(t=tinyMCE.activeEditor.getContent()),t}return{checkInput:e}}]);var AlertsFactory=angular.module("AlertsFactory",[]);AlertsFactory.factory("Alerts",["$http",function(t){function e(t){var e=confirm("Biztosan végre szeretné hajtani a változtatásokat?");e&&t()}function o(t){1==t?alert("Feladat sikeresen végrehajtva!"):alert("Nem sikerült a feladatot végehajtani!")}return{checkSuccess:o,confirmChange:e}}]);